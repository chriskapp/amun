(function(b){var a={};a.services={};a.store={};a.store.editors={};a.store.files={};a.client=function(l){var o=this;var c="POST";var d="POST";var j;var n="application/x-www-form-urlencoded";var f={};var k=true;var i=l;var e;var g;var m;var h;this.getContainerId=function(){return i};this.getData=function(){return f};this.setData=function(p){f=p};this.getContentType=function(){return n};this.setContentType=function(p){n=p};this.setProcessData=function(p){k=p};this.onSuccess=function(p){e=p};this.onError=function(p){g=p};this.beforeSubmit=function(p){m=p};this.afterSubmit=function(p){h=p};this.request=function(p,r,q){this.setData(q);if(m){m.call(o)}switch(r){case"GET":c="GET";d="GET";break;case"POST":c="POST";d="POST";break;case"PUT":c="POST";d="PUT";break;case"DELETE":c="POST";d="DELETE";break}$.ajax({type:c,url:p,contentType:n,data:q,processData:k,dataType:"json",beforeSend:function(s){s.setRequestHeader("X-Http-Method-Override",d);s.setRequestHeader("Accept","application/json")},error:function(w,s,u){var t=JSON.parse(w.responseText);var v;if(typeof(t.text)!="undefined"){v=t.text}else{if(s!=null){v=s}else{v="An unknown error occured"}}if(g){g.call(o,v)}if(h){h.call(o)}},success:function(t,s,u){if(t.success){if(e){e.call(o,t.text)}}else{if(g){g.call(o,t.text)}}if(h){h.call(o)}}})};if(l){$("#"+l).unbind("submit");$("#"+l).submit(function(){var p=$(this).attr("method").toUpperCase();var q=$(this).attr("action");var y=$(this).attr("enctype");var u=$(this).serializeArray();var w={};for(var t=0;t<u.length;t++){w[u[t].name]=u[t].value}if(typeof a.store.editors!="undefined"){for(var r in a.store.editors){var x=a.store.editors[r];var A=x.getSession().getValue();w[r]=A}}var s;switch(y){case"multipart/form-data":s=new FormData();for(var z in w){s.append(z,w[z])}for(var z in a.store.files){s.append(z,a.store.files[z])}o.setContentType(false);o.setProcessData(false);break;case"application/json":s=JSON.stringify(w);o.setContentType("application/json");break;default:case"application/x-www-form-urlencoded":s=w;o.setContentType("application/x-www-form-urlencoded");break}o.request(q,p,s);return false})}};a.form=function(k,e){var l=this;var j;var d;var g;var c;var f;var h;var i;this.getContainerId=function(){return j};this.onLoad=function(m){h=m};this.onError=function(m){i=m};this.transform=function(m){$("#"+this.getContainerId()).html(l.parseElements(m));if(m.enctype=="multipart/form-data"){$("#"+this.getContainerId()).find('input[type="file"]').each(function(){$(this).change(l.handleFileUpload)})}if(h){h.call(l,m.ref)}};this.parseElements=function(z){if(typeof(z.success)!="undefined"&&z.success==false){var n=document.createElement("p");n.setAttribute("class","alert alert-notice");n.appendChild(document.createTextNode(z.text));return n}switch(z["class"]){case"form":var o=document.createElement("form");o.setAttribute("id",z.ref);o.setAttribute("method",z.method);o.setAttribute("action",z.action);o.setAttribute("enctype",z.enctype);for(var s=0;s<z.item.children.item.length;s++){o.appendChild(this.parseElements(z.item.children.item[s]))}var n=document.createElement("p");var w=document.createElement("input");w.setAttribute("class","btn btn-primary");w.setAttribute("type","submit");w.setAttribute("value","Submit");n.appendChild(w);o.appendChild(n);return o;break;case"panel":var A=document.createElement("fieldset");var y=document.createElement("legend");y.appendChild(document.createTextNode(z.label));A.appendChild(y);for(var s=0;s<z.children.item.length;s++){A.appendChild(this.parseElements(z.children.item[s]))}return A;break;case"captcha":var n=document.createElement("p");var v=document.createElement("label");v.setAttribute("for",z.ref);v.appendChild(document.createTextNode(z.label));var r=document.createElement("img");r.setAttribute("src",z.src);r.setAttribute("alt","Captcha");var w=document.createElement("input");w.setAttribute("type","text");w.setAttribute("name",z.ref);w.setAttribute("id",z.ref);w.setAttribute("value",z.value||"");if(z.disabled){w.setAttribute("disabled","disabled")}return n;break;case"datalist":break;case"reference":var n=document.createElement("p");var v=document.createElement("label");v.setAttribute("for",z.ref);v.appendChild(document.createTextNode(z.label));var w=document.createElement("input");w.setAttribute("type","text");w.setAttribute("name",z.ref);w.setAttribute("id",z.ref);w.setAttribute("value",z.value||"");if(z.disabled){w.setAttribute("disabled","disabled")}return n;break;case"input":var w=document.createElement("input");w.setAttribute("type",z.type);w.setAttribute("name",z.ref);w.setAttribute("id",z.ref);w.setAttribute("value",z.value||"");if(z.disabled){w.setAttribute("disabled","disabled")}switch(z.type){case"hidden":return w;break;default:var n=document.createElement("p");var v=document.createElement("label");v.setAttribute("for",z.ref);v.appendChild(document.createTextNode(z.label));n.appendChild(v);n.appendChild(w);return n;break}break;case"select":var n=document.createElement("p");var v=document.createElement("label");v.setAttribute("for",z.ref);v.appendChild(document.createTextNode(z.label));var u=document.createElement("select");u.setAttribute("name",z.ref);u.setAttribute("id",z.ref);if(z.disabled){u.setAttribute("disabled","disabled")}for(var q=0;q<z.children.item.length;q++){var m=z.children.item[q];var t=document.createElement("option");t.setAttribute("value",m.value);if(z.value==m.value){t.setAttribute("selected","selected")}t.appendChild(document.createTextNode(m.label));u.appendChild(t)}n.appendChild(v);n.appendChild(u);return n;break;case"textarea":var n=document.createElement("p");var v=document.createElement("label");v.setAttribute("for",z.ref);v.appendChild(document.createTextNode(z.label));var x=document.createElement("textarea");x.setAttribute("name",z.ref);x.setAttribute("id",z.ref);if(z.disabled){x.setAttribute("disabled","disabled")}x.appendChild(document.createTextNode(z.value||""));n.appendChild(v);n.appendChild(x);return n;break}};this.handleFileUpload=function(q){var p=q.target.files;for(var o=0;o<p.length;o++){var m=$(this).attr("name");var n=p[o];a.store.files[m]=n}};j=k;$.ajax({type:"GET",url:e,dataType:"json",beforeSend:function(m){m.setRequestHeader("Accept","application/json")},error:function(o,m,n){if(i){i.call(l,n)}},success:function(n,m,o){if(typeof n.success!="undefined"&&!n.success){if(i){i.call(l,n.text)}}else{l.transform(n)}}})};a.util={getParentLocation:function(){var c=""+location;var d=c.lastIndexOf("/");return d!=-1?c.substr(0,d):c},getSqlToDate:function(h){var f=h.split(" ");var c=f[0].split("-");var e=f[1].split(":");var g=new Date();g.setUTCDate(c[0]);g.setUTCMonth(c[1]);g.setUTCFullYear(c[2]);g.setUTCHours(e[0]);g.setUTCMinutes(e[1]);g.setUTCSeconds(e[2]);return g}};b.amun=a})(window);