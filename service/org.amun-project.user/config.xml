<?xml version="1.0" encoding="UTF-8"?>
<service xmlns="http://amun-project.org" signature="5f1951ceb935bf2f5e3c282481135ee0b872715b">
  <status>system</status>
  <name>user</name>
  <description>Basic service wich handles user groups and rights</description>
  <path>/user</path>
  <namespace>user</namespace>
  <type>http://ns.amun-project.org/2011/amun/service/user</type>
  <link>http://amun.phpsx.org</link>
  <author><![CDATA[Christoph Kappestein <k42b3.x@gmail.com>]]></author>
  <license>GPLv3</license>
  <version>0.0.1</version>
  <provider>http://amun-project.org</provider>
  <api>
    <service>
      <type>http://ns.amun-project.org/2011/amun/service/user/account</type>
      <type>http://ns.amun-project.org/2011/amun/data/1.0</type>
      <uri>/account</uri>
    </service>
    <service>
      <type>http://ns.amun-project.org/2011/amun/service/user/activity</type>
      <type>http://ns.amun-project.org/2011/amun/data/1.0</type>
      <uri>/activity</uri>
    </service>
    <service>
      <type>http://ns.amun-project.org/2012/amun/user/activity/message/1.0</type>
      <uri>/activity/message</uri>
    </service>
    <service>
      <type>http://ns.amun-project.org/2011/amun/service/user/friend</type>
      <type>http://ns.amun-project.org/2011/amun/data/1.0</type>
      <uri>/friend</uri>
    </service>
    <service>
      <type>http://ns.amun-project.org/2011/amun/user/friend/relation/1.0</type>
      <uri>/friend/relation</uri>
    </service>
    <service>
      <type>http://ns.amun-project.org/2011/amun/service/user/friend/group</type>
      <type>http://ns.amun-project.org/2011/amun/data/1.0</type>
      <uri>/friend/group</uri>
    </service>
    <service>
      <type>http://ns.amun-project.org/2011/amun/service/user/group</type>
      <type>http://ns.amun-project.org/2011/amun/data/1.0</type>
      <uri>/group</uri>
    </service>
    <service>
      <type>http://ns.amun-project.org/2011/amun/service/user/group/right</type>
      <type>http://ns.amun-project.org/2011/amun/data/1.0</type>
      <uri>/group/right</uri>
    </service>
    <service>
      <type>http://ns.amun-project.org/2011/amun/service/user/right</type>
      <type>http://ns.amun-project.org/2011/amun/data/1.0</type>
      <uri>/right</uri>
    </service>
  </api>
  <permissions>
    <perm name="view" description="User view"/>
    <perm name="add" description="User add"/>
    <perm name="edit" description="User edit"/>
    <perm name="delete" description="User delete"/>
    <perm name="account_view" description="User Account view"/>
    <perm name="account_add" description="User Account add"/>
    <perm name="account_edit" description="User Account edit"/>
    <perm name="account_delete" description="User Account delete"/>
    <perm name="activity_view" description="User Activity view"/>
    <perm name="activity_add" description="User Activity add"/>
    <perm name="activity_edit" description="User Activity edit"/>
    <perm name="activity_delete" description="User Activity delete"/>
    <perm name="activity_receiver_view" description="User Activity Receiver view"/>
    <perm name="activity_receiver_add" description="User Activity Receiver add"/>
    <perm name="activity_receiver_edit" description="User Activity Receiver edit"/>
    <perm name="activity_receiver_delete" description="User Activity Receiver delete"/>
    <perm name="friend_view" description="User Friend view"/>
    <perm name="friend_add" description="User Friend add"/>
    <perm name="friend_edit" description="User Friend edit"/>
    <perm name="friend_delete" description="User Friend delete"/>
    <perm name="friend_group_view" description="User Friend Group view"/>
    <perm name="friend_group_add" description="User Friend Group add"/>
    <perm name="friend_group_edit" description="User Friend Group edit"/>
    <perm name="friend_group_delete" description="User Friend Group delete"/>
    <perm name="group_view" description="User Group view"/>
    <perm name="group_add" description="User Group add"/>
    <perm name="group_edit" description="User Group edit"/>
    <perm name="group_delete" description="User Group delete"/>
    <perm name="group_right_view" description="User Group Right view"/>
    <perm name="group_right_add" description="User Group Right add"/>
    <perm name="group_right_edit" description="User Group Right edit"/>
    <perm name="group_right_delete" description="User Group Right delete"/>
    <perm name="right_view" description="User Right view"/>
    <perm name="right_add" description="User Right add"/>
    <perm name="right_edit" description="User Right edit"/>
    <perm name="right_delete" description="User Right delete"/>
  </permissions>
  <registry>
    <table name="user_account"/>
    <table name="user_activity"/>
    <table name="user_activity_receiver"/>
    <table name="user_activity_template"/>
    <table name="user_friend"/>
    <table name="user_friend_group"/>
    <table name="user_group"/>
    <table name="user_group_right"/>
    <table name="user_right"/>
  </registry>
  <event>
    <listener name="core.record_change" class="\AmunService\User\Activity\RecordListener"/>
    <listener name="core.service_install" class="\AmunService\User\Activity\ConfigListener"/>
    <listener name="core.service_install" class="\AmunService\User\Right\ConfigListener"/>
    <listener name="lrdd.resource_discovery" class="\AmunService\User\LrddListener"/>
  </event>
  <library>
    <dir name="AmunService">
      <dir name="User">
        <file name="LrddListener.php" md5="e931d5484a8f469829adecc726147e7a"/>
        <dir name="Account">
          <dir name="Filter">
            <file name="Email.php" md5="f1853e34bdf6fbd7c48b61ad8f7d09ac"/>
            <file name="Gender.php" md5="6aa33199229a18ae1beae36473fe05aa"/>
            <file name="Identity.php" md5="edd2c99a4873a727972661e30c51abb7"/>
            <file name="Name.php" md5="b0a50fc35753c7d4bca6554ac1dfb12d"/>
            <file name="Pw.php" md5="3783f4ce26b77895e2463d36b75592b2"/>
            <file name="Status.php" md5="dea91b0a99d00aecd1f44b08c741bb43"/>
            <file name="Timezone.php" md5="a6c190c65c83c7fc54848d6da62035d3"/>
          </dir>
          <file name="Form.php" md5="3cdd6ba025cb0ec03685d9ee4ad851c3"/>
          <file name="Handler.php" md5="6e020706a9d0bcfee73727c11448fe39"/>
          <file name="Record.php" md5="da204614b9d66d6fb35478def5706ebc"/>
          <file name="Stream.php" md5="a25bc2dd2a294496d6114d538ab4453b"/>
          <file name="Table.php" md5="f3c1a68517ba07c9bcb1276d7c1c3049"/>
        </dir>
        <dir name="Activity">
          <file name="ConfigListener.php" md5="fc1f0e6c35fd0d88c8936abd203a9524"/>
          <dir name="Filter">
            <file name="Verb.php" md5="5e3c38ab718df77feb9b3fa7bddb9c7c"/>
          </dir>
          <file name="Form.php" md5="abf85bab6236f607cc37eef9bb5fc1e2"/>
          <file name="Handler.php" md5="d7abc7009b093d11067706f2072df7f4"/>
          <dir name="Receiver">
            <dir name="Filter">
              <file name="Status.php" md5="90c8b62870c5c9646f1f0306d04ecbff"/>
            </dir>
            <file name="Handler.php" md5="1eac03e8072a0f9498da8edb9a5578aa"/>
            <file name="Record.php" md5="e726cde473e1839c3b3dd9136a61b750"/>
            <file name="Table.php" md5="5ddc70df95dc380c5282aa1e9b4eecc4"/>
          </dir>
          <file name="Record.php" md5="2515246b6536cda7bdac9bcdee277aea"/>
          <file name="RecordListener.php" md5="6cfde920da9f14d514f413eb0cb27f44"/>
          <file name="Stream.php" md5="43c400711ac4c30a765e682a44075043"/>
          <file name="Table.php" md5="a5b7221be578e4ea1b2a4e17a2f0fa4c"/>
        </dir>
        <dir name="Friend">
          <dir name="Filter">
            <file name="Status.php" md5="273f0dbe55f74a35dd562e6cd9e227a0"/>
          </dir>
          <file name="Form.php" md5="cf162e3e7883144ecfd2d0a5445b8967"/>
          <dir name="Group">
            <file name="Form.php" md5="4d819608748416b00c5890da343795e9"/>
            <file name="Handler.php" md5="c2e60c1a5f1b7d8f544cefc0106209e7"/>
            <file name="Record.php" md5="227829231250d05f4b7fdb059cce1077"/>
            <file name="Table.php" md5="941e1059d1c7ae176f5eaae57d18eefd"/>
          </dir>
          <file name="Handler.php" md5="3c692aadb9d9b5da6883021a7eb07b3a"/>
          <file name="Record.php" md5="636b7fbbd301e21f775a233fd34bbba0"/>
          <file name="Relation.php" md5="54442e94b51ce612215aba026c8dfd29"/>
          <file name="Table.php" md5="db7c85ae5dc08af93797b20ecd325679"/>
          <file name="Stream.php" md5="30cbe6cc3f9c3945b2f47d2afe0586c8"/>
        </dir>
        <dir name="Group">
          <file name="Form.php" md5="ca2b9d523589e9d5c09a24d402757e6b"/>
          <file name="Handler.php" md5="1b6c5f59cdee2d24130a74329b3fba79"/>
          <file name="Record.php" md5="f5825c6e54b3199de553ed8e32022e0c"/>
          <dir name="Right">
            <file name="Form.php" md5="511e2d7c325f3b2791dcfbf42668aa78"/>
            <file name="Handler.php" md5="6560a9de410be5dd3cdd587c8775f4a0"/>
            <file name="Record.php" md5="63cc7be0f8ae941afbedee85076e3e80"/>
            <file name="Table.php" md5="16d5798339db5b6c09f63987edfedb7b"/>
          </dir>
          <file name="Table.php" md5="ae1afc4bdfd7dc943c1ecd2dd76eceef"/>
        </dir>
        <dir name="Right">
          <file name="ConfigListener.php" md5="deb028f73eb26de51bdafd899f905914"/>
          <file name="Form.php" md5="5820007f6fac4ede9daa198631ced452"/>
          <file name="Handler.php" md5="2ca7f576c0f7d7509de5fc16931e657c"/>
          <file name="Record.php" md5="789335573c06a6ac4fb3de13f425c567"/>
          <file name="Table.php" md5="ba3386ef42da223b9d6a4e9da2d4b683"/>
        </dir>
      </dir>
    </dir>
  </library>
  <database>
    <query><![CDATA[CREATE TABLE IF NOT EXISTS `{table.user_account}` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `globalId` varchar(36) NOT NULL,
  `groupId` int(10) NOT NULL,
  `hostId` int(10) NOT NULL DEFAULT '0',
  `countryId` int(10) NOT NULL,
  `status` int(10) NOT NULL,
  `identity` varchar(40) NOT NULL,
  `name` varchar(32) NOT NULL,
  `pw` varchar(40) NOT NULL,
  `email` varchar(64) DEFAULT NULL,
  `token` varchar(40) NOT NULL,
  `ip` varchar(40) NOT NULL,
  `gender` enum('male','female','undisclosed') NOT NULL DEFAULT 'undisclosed',
  `profileUrl` varchar(256) NOT NULL,
  `thumbnailUrl` varchar(256) DEFAULT NULL,
  `longitude` double NOT NULL DEFAULT '0',
  `latitude` double NOT NULL DEFAULT '0',
  `timezone` varchar(32) NOT NULL DEFAULT 'UTC',
  `lastSeen` datetime NOT NULL,
  `updated` datetime NOT NULL,
  `date` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `identity` (`identity`),
  UNIQUE KEY `token` (`token`),
  UNIQUE KEY `hostIdName` (`hostId`,`name`),
  UNIQUE KEY `globalId` (`globalId`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8;]]></query>
    <query><![CDATA[CREATE TABLE IF NOT EXISTS `{table.user_activity}` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `globalId` varchar(36) NOT NULL,
  `parentId` int(10) NOT NULL DEFAULT '0',
  `userId` int(10) NOT NULL,
  `refId` int(10) NOT NULL DEFAULT '0',
  `table` varchar(32) DEFAULT NULL,
  `scope` int(10) NOT NULL DEFAULT '0',
  `verb` enum('post','add','cancel','checkin','delete','favorite','follow','give','ignore','invite','join','leave','like','make-friend','play','receive','remove','remove-friend','request-friend','rsvp-maybe','rsvp-no','rsvp-yes','save','share','stop-following','tag','unfavorite','unlike','unsave','update') NOT NULL,
  `summary` text NOT NULL,
  `date` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `globalId` (`globalId`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8]]></query>
    <query><![CDATA[CREATE TABLE IF NOT EXISTS `{table.user_activity_receiver}` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `status` int(10) NOT NULL DEFAULT '1',
  `activityId` int(10) NOT NULL,
  `userId` int(10) NOT NULL,
  `date` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=ascii]]></query>
    <query><![CDATA[CREATE TABLE IF NOT EXISTS `{table.user_activity_template}` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `type` enum('INSERT','UPDATE','DELETE') NOT NULL,
  `verb` enum('post','add','cancel','checkin','delete','favorite','follow','give','ignore','invite','join','leave','like','make-friend','play','receive','remove','remove-friend','request-friend','rsvp-maybe','rsvp-no','rsvp-yes','save','share','stop-following','tag','unfavorite','unlike','unsave','update') NOT NULL,
  `table` varchar(64) NOT NULL,
  `path` varchar(256) NOT NULL,
  `summary` text NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `type_table` (`type`,`table`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8]]></query>
    <query><![CDATA[CREATE TABLE IF NOT EXISTS `{table.user_friend}` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `status` int(10) NOT NULL,
  `groupId` int(10) NOT NULL DEFAULT '0',
  `userId` int(10) NOT NULL,
  `friendId` int(10) NOT NULL,
  `date` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `userFriendId` (`userId`,`friendId`)
) ENGINE=MyISAM DEFAULT CHARSET=ascii]]></query>
    <query><![CDATA[CREATE TABLE IF NOT EXISTS `{table.user_friend_group}` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `userId` int(10) NOT NULL,
  `title` varchar(64) NOT NULL,
  `date` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8]]></query>
    <query><![CDATA[CREATE TABLE IF NOT EXISTS `{table.user_group}` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `title` varchar(32) NOT NULL,
  `date` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8]]></query>
    <query><![CDATA[CREATE TABLE IF NOT EXISTS `{table.user_group_right}` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `groupId` int(10) NOT NULL,
  `rightId` int(10) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `groupRightId` (`groupId`,`rightId`)
) ENGINE=MyISAM DEFAULT CHARSET=ascii;]]></query>
    <query><![CDATA[CREATE TABLE IF NOT EXISTS `{table.user_right}` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `serviceId` int(10) NOT NULL,
  `name` varchar(64) NOT NULL,
  `description` varchar(128) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=MyISAM DEFAULT CHARSET=ascii]]></query>
  </database>
</service>
